# -*- coding: utf-8 -*-
"""SciBERT demo.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1HUoQiRKgwlTfZv44ZT8vrJqtSY9B2sXE
"""

!pip install --quiet scann
# !pip install --quiet datasets
# !pip install --quiet pipreqsnb
import pandas as pd 
import numpy as np 
import tensorflow as tf 
from tensorflow import keras 
from tensorflow.keras import layers, Input, Model
from tensorflow.keras.layers import *
import tensorflow_hub as hub 

import scann
# from data_loader import data_loader
from negative_maker import negative_maker
from model import model

use_hub = hub.load("https://tfhub.dev/google/universal-sentence-encoder/4") ## universal sentence encoder model

from google.colab import drive
drive.mount('/content/drive')
triplet_model = model()
triplet_model.load_weights('drive/MyDrive/Colab Notebooks/quick_response/triplet_model_weights.h5')

use_emb =  triplet_model.get_layer('sentence_encoder')

test_quest = 'Why do you get chills/goosebumps from hearing large crowds sing along to songs?'

test_quest_emb = np.array(use_emb(([test_quest]))).reshape(1,512)

searcher = scann.scann_ops_pybind.load_searcher('./')

index, distance = searcher.search(test_quest_emb.ravel())
index

